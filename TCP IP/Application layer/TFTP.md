# TFTP: 单文件传送协议
> 简单文件传送协议，最初打算用于引导无盘系统
（通常是工作站或X终端）。和将在第2 7章介绍的使用T C P的文件传送协议（F T P）不同，为了
保持简单和短小，T F T P将使用U D P。T F T P的代码（和它所需要的 U D P、I P和设备驱动程序）
都能适合只读存储器。
RFC 1350 [Sollins 1992]是第2版T F T P的正式规范。第1 2章 [Stevens 1990] 提供了实现
T F T P客户和服务器的全部源代码，并介绍了一些使用 T F T P的编程技术。

## 协议
在开始工作时，T F T P的客户与服务器交换信息，客户发送一个读请求或写请求给服务器。
在一个无盘系统进行系统引导的正常情况下，第一个请求是读请求 RRQ模式字段
是一个A S C I I码串n e t a s c i i或o c t e t（可大小写任意组合），同样以0字节结束netascii
表示数据是以成行的A S C I I码字符组成，以两个字节 — 回车字符后跟换行字符（称为C R / L F）
作为行结束符。这两个行结束字符在这种格式和本地主机使用的行定界符之间进行转化。
o c t e t则将数据看作8 bit一组的字节流而不作任何解释。
每个数据分组包含一个块编号字段，它以后要在确认分组中使用。以读一个文件作为例
子，T F T P客户需要发送一个读请求说明要读的文件名和文件模式 ( m o d e )。如果这个文件能被
这个客户读取，T F T P服务器就返回一个块编号为 1的数据分组。
 T F T P的优点在于实现的简单而不是高的系统吞吐量。
 
 * 安全性
注意在T F T P分组（图1 5 - 1）中并不提供用户名和口令。这是 T F T P的一个特征（即“安全
漏洞”）。由于T F T P是设计用于系统引导进程，它不可能提供用户名和口令。
T F T P的这一特性被许多解密高手用于获取 U n i x口令文件的复制，然后来猜测用户口令。
为防止这种类型的访问，目前大多数 T F T P服务器提供了一个选项来限制只能访问特定目录下
的文件（U n i x系统中通常是/ t f t p b o o t）。这个目录中只包含无盘系统进行系统引导时所需
的文件。
对其他的安全性，U n i x系统下的T F T P服务器通常将它的用户I D和组I D设置为不会赋给任
何真正用户的值。这只允许访问具有读或写属性的文件

### 小结
T F T P是一个简单的协议，适合于只读存储器，仅用于无盘系统进行系统引导。它只使用
几种报文格式，是一种停止等待协议。
 为了允许多个客户端同时进行系统引导， T F T P服务器必须提供一定形式的并发。因为
U D P在一个客户与一个服务器之间并不提供唯一连接（ T C P也一样），T F T P服务器通过为每
个客户提供一个新的 U D P端口来提供并发。这允许不同的客户输入数据报，然后由服务器中
的U D P模块根据目的端口号进行区分，而不是由服务器本身来进行区分。
T F T P协议没有提供安全特性。大多数执行指望 T F T P服务器的系统管理员来限制客户的访
问，只允许它们访问引导所必须的文件。
