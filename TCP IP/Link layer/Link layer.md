# Link layer

* 为IP模块发送和接收IP数据报；
* 为ARP模块发送A RP请求和接收ARP应答；
* 为RARP发送RARP请求和接收RARP应答。TC/IP支持多种不同的链路层协议，这取决于网络所使用的硬件，如以太网、令牌环网、FDDI（光纤分布式数据接口）及R S-232串行线路等。


## 链路层协议
* 两个串行接口链路层协议（SLIP和PPP）
* 以及大多数实现都包含的环回（loopback）驱动程序。
* 以太网和SLIP是本书中大多数例子使用的链路层。对MTU（最大传输单元）这如何为串行线路选择 M T U。


## 以太网和IEEE 802封装

* 以太网这个术语一般是指数字设备公司英特尔公司和Xerox公司在1982年联合公布的一个标准它是TCP/IP采用的主要的局域网技术
 * 采用一种称作 CSMA/C D的媒体接入方法，其意思是带冲突检测的载波侦听多路接入（Carrier Sense, Multiple Access with Collision Detection）它的速率为10 Mb/s，地址为48 bit
* IEEE（电子电气工程师协会） 802委员会公布了一个稍有不同的标准集
  * 8023针对整个CSMA/CD网络
  * 802.4针对令牌总线网络
  * 802.5针对令牌环网络。
    * 这三者的共同特性由802.2标准来定义，那就是802网络共有的逻辑链路控制（LLC）
    * 不幸的是，802.2和802.3定义了一个与以太网不同的帧格式。文献 [Stallings 1987]对所有的IEEE 802标准进行了详细的介绍
    
* TCP/IP中以太网
  * IP数据报封装是在RFC 894[Hornig 1984]中定义的
  * IEEE 802网络的IP数据报封装是在RFC 1042[Postel and Reynolds 1988]中定义的 
    1. 必须能发送和接收采用RFC 894（以太网）封装格式的分组。
    2. 应该能接收与RFC 894混合的RFC 1042（IEEE 802）封装格式的分组。
    3. 也许能够发送采用RFC 1042格式封装的分组 如果主机能同时发送两种类型的分组数据 发送的分组必须是可以设置的而且默认条件下必须是 RFC 894分组
  * 常使用的封装格式是 RFC 894定义的格式
  * 802定义的有效长度值与以太网的有效类型值无一相同，这样，就可以对两种帧格式进行区分
  
*  在以太网帧格式中，类型字段之后就是数据；而在 8 0 2帧格式中，跟随在后面的是 3字节的802.2 LLC和5字节的802.2 SNAP。
 * 目的服务访问点（ Destination Service Access Point,DSAP）和源服务访问点（Source Service Access Point, SSAP)值都设为0xaaCtrl字段的值设为3。随后的3个字节orgcode都置为0。再接下来的2个字节类型字段和以太网帧格式一样（其他类型字段值可以参见RFC 1340
  * CRC字段用于帧内后续字节差错的循环冗余码检验（检验和）（它也被称为FCS或帧检验序列）。
 
 ---

* 尾部封装
 * RFC 893描述了另一种用于以太网的封装格式，称作尾部封装（trailer encapsulation）
 * 早期BSD系统在DEC VA X机上运行时的试验格式，它通过调整I P数据报中字段的次序来提高性能。
 * 以太网数据帧中，开始的那部分是变长的字段（IP首部和TCP首部）。移到尾部（在 CR C之前），这样当把数据复制到内核时，就可以把数据帧中的数据部分映射到一个硬件页面，节省内存到内存的复制过程。
 * T C P数据报的长度是52字节的整数倍，正好可以用内核中的页表来处理。两台主机通过协商使用 A R P扩展协议对数据帧进行尾部封装。这些数据帧需定义不同的以太网帧类型值
 
 
 ---
 
 
 
